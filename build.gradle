

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath 'com.github.jengelman.gradle.plugins:shadow:1.2.4'
        classpath "com.palantir.gradle.gitversion:gradle-git-version:0.8.0"
    }
}

apply plugin: 'groovy'

apply plugin: 'com.github.johnrengelman.shadow'
apply plugin: 'java'
apply plugin: "com.palantir.git-version"


repositories {
    mavenLocal()
    maven { url 'http://jcenter.bintray.com'}
    maven { url 'https://dl.bintray.com/hmrc/releases'}
}

dependencies {
    compile 'uk.gov.hmrc:jenkins-job-builders:10.5.0'
    compile 'org.codehaus.groovy:groovy:2.1.3'
    compile ('com.google.guava:guava:11.0.1') {
        exclude module: 'jsr305'
    }
    compile ('org.jenkins-ci.plugins:job-dsl-core:1.29') {
        exclude module: 'ivy'
    }
    testCompile 'org.spockframework:spock-core:0.7-groovy-2.0'
    testCompile 'org.jenkins-ci:version-number:1.1'
}

task relativeDependencies(type: Copy) {
    from configurations.compile
    into 'build/libs'
    include '**/**/jenkins-job-builders*.jar'
}

project.tasks.build.dependsOn(relativeDependencies)

version gitVersion()

//def details = versionDetails()
//details.lastTag
//details.commitDistance
//details.gitHash
//details.branchName // is null if the repository in detached HEAD mode
//details.isCleanTag
//
//println(details.toString())